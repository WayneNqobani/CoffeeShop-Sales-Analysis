SELECT
  *
FROM
  "COFFEESHOP"."DATA"."COFFEEDATA"
;

----------CHECKING UNIQUE VALUES /CATEGORIES

---9 PTODUCT CATEGORIES
SELECT DISTINCT PRODUCT_CATEGORY
FROM
  "COFFEESHOP"."DATA"."COFFEEDATA"
;
-----3 STORE LOCATIONS
SELECT DISTINCT STORE_LOCATION
FROM
  "COFFEESHOP"."DATA"."COFFEEDATA"
;

------- 29 PRODUCT TYPES
SELECT DISTINCT PRODUCT_TYPE
FROM
  "COFFEESHOP"."DATA"."COFFEEDATA"
;
------ 80 PRODUCT DETAILS
SELECT DISTINCT PRODUCT_DETAIL
FROM
  COFFEESHOP.DATA.COFFEEDATA
;

------



--
CREATE OR REPLACE TEMP TABLE COFFEESHOP.DATA.COFFEEDATA_CLEAN AS
SELECT
    TRANSACTION_ID,
    UNIT_PRICE,
    PRODUCT_CATEGORY,
    PRODUCT_TYPE,
    STORE_LOCATION,
    TRANSACTION_QTY,
    TRANSACTION_TIME AS tt,
  --our date is saved in TIMESTAMP COLUMN no need to use TRY_TO_TIMESTAMP  we just use CAST function
    TRANSACTION_DATE AS ts,
    CAST(TRANSACTION_DATE AS DATE) AS sale_date,
    DAYNAME(TRANSACTION_DATE) AS day_name,
    MONTHNAME(TRANSACTION_DATE) AS month_name ,


    CASE
        WHEN HOUR(tt) BETWEEN 5
        AND 11 THEN 'Morning'
        WHEN HOUR(tt) BETWEEN 12
        AND 16 THEN 'Midday'
        WHEN HOUR(tt) BETWEEN 17
        AND 23 THEN 'Evening'
        ELSE 'Late Night'
    END AS TIME_BUCKET,

    
FROM COFFEESHOP.DATA.COFFEEDATA;

SELECT 

-------------------------CUSTOMER COUNT
COUNT(*) AS CUSTOMER_COUNT
FROM COFFEESHOP.DATA.COFFEEDATA;
------------ TOTAL REVENUE
SELECT 
SUM(UNIT_PRICE) AS REVENUE
FROM COFFEESHOP.DATA.COFFEEDATA;

--  TOTAL PRODUCTS SOLD
SELECT
SUM(TRANSACTION_QTY) AS PRODUCTS_SOLD,
FROM COFFEESHOP.DATA.COFFEEDATA;

---
SELECT
 MIN(UNIT_PRICE) AS Cheapest_Product,
 MAX(UNIT_PRICE) AS highest_priced_product
FROM COFFEESHOP.DATA.COFFEEDATE;

 

